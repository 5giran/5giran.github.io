<!DOCTYPE html>
<html lang="ko">
<head>
  {% include head.html %}
</head>
<body>
  <div class="site">
    <!-- Header with hamburger menu -->
    <header class="site-header">
      <div class="header-container">
        <a href="{{ site.baseurl }}/" class="site-title">{{ site.title }}</a>
        <button class="hamburger-menu" id="hamburgerBtn" aria-label="메뉴 열기">
          <span></span>
          <span></span>
          <span></span>
        </button>
      </div>
    </header>

    <!-- Side Navigation -->
    <nav class="side-nav" id="sideNav">
      <div class="side-nav-header">
        <button class="close-btn" id="closeBtn" aria-label="메뉴 닫기">&times;</button>
      </div>
      
      <div class="profile-section">
        <div class="profile-image">
          <img src="{{ '/assets/profile.jpg' | relative_url }}" alt="5giran 프로필" onerror="this.style.display='none'">
          <div class="profile-placeholder">5G</div>
        </div>
        <h3>5giran</h3>
        <p>매일 꾸준히 성장하는 개발자</p>
        <div class="social-links">
          <a href="mailto:{{ site.email }}" title="이메일">📧</a>
          <a href="https://github.com/5giran" title="GitHub" target="_blank">🐙</a>
        </div>
      </div>

      <div class="menu-section">
        <h4>카테고리</h4>
        <ul class="menu-list">
          <li><a href="{{ site.baseurl }}/">🏠 홈</a></li>
          <li><a href="{{ site.baseurl }}/categories/algorithm">🧮 Algorithm</a></li>
          <li><a href="{{ site.baseurl }}/categories/ios">📱 iOS</a></li>
          <li><a href="{{ site.baseurl }}/about">👨‍💻 About</a></li>
        </ul>
      </div>

      <div class="status-section">
        <h4>최근 활동</h4>
        <div class="calendar-widget">
          <div class="calendar-header">
            <button class="calendar-nav" id="prevMonth">‹</button>
            <div class="calendar-month" id="calendarMonth"></div>
            <button class="calendar-nav" id="nextMonth">›</button>
          </div>
          <div class="calendar-weekdays">
            <div class="weekday">일</div>
            <div class="weekday">월</div>
            <div class="weekday">화</div>
            <div class="weekday">수</div>
            <div class="weekday">목</div>
            <div class="weekday">금</div>
            <div class="weekday">토</div>
          </div>
          <div class="calendar-dates" id="calendarDates">
            <!-- Calendar dates will be generated by JavaScript -->
          </div>
        </div>
      </div>
    </nav>

    <!-- Overlay -->
    <div class="overlay" id="overlay"></div>

    <!-- Main Content -->
    <main class="site-content">
      {{ content }}
    </main>

    <!-- Footer -->
    <footer class="site-footer">
      <div class="footer-content">
        <p>&copy; {{ 'now' | date: "%Y" }} {{ site.author }}. All rights reserved.</p>
      </div>
    </footer>
  </div>

  <!-- JavaScript for hamburger menu and calendar -->
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const hamburgerBtn = document.getElementById('hamburgerBtn');
      const sideNav = document.getElementById('sideNav');
      const closeBtn = document.getElementById('closeBtn');
      const overlay = document.getElementById('overlay');

      function openNav() {
        sideNav.classList.add('active');
        overlay.classList.add('active');
        document.body.style.overflow = 'hidden';
      }

      function closeNav() {
        sideNav.classList.remove('active');
        overlay.classList.remove('active');
        document.body.style.overflow = '';
      }

      hamburgerBtn.addEventListener('click', openNav);
      closeBtn.addEventListener('click', closeNav);
      overlay.addEventListener('click', closeNav);

      // Close menu when clicking on menu links
      const menuLinks = sideNav.querySelectorAll('a');
      menuLinks.forEach(link => {
        link.addEventListener('click', closeNav);
      });

      // Close menu with Escape key
      document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape' && sideNav.classList.contains('active')) {
          closeNav();
        }
      });

      // Calendar functionality
      const calendarMonth = document.getElementById('calendarMonth');
      const calendarDates = document.getElementById('calendarDates');
      const prevBtn = document.getElementById('prevMonth');
      const nextBtn = document.getElementById('nextMonth');
      
      let currentDate = new Date();
      
      // Blog post dates (you can dynamically generate this from Jekyll)
      const postDates = [
        {% for post in site.posts limit:20 %}
          '{{ post.date | date: "%Y-%m-%d" }}'{% unless forloop.last %},{% endunless %}
        {% endfor %}
      ];
      
      function generateCalendar() {
        const year = currentDate.getFullYear();
        const month = currentDate.getMonth();
        const today = new Date();
        
        // Update month title
        const months = ['1월', '2월', '3월', '4월', '5월', '6월', '7월', '8월', '9월', '10월', '11월', '12월'];
        calendarMonth.textContent = months[month];
        
        // Clear previous dates
        calendarDates.innerHTML = '';
        
        // Get first day of month and number of days
        const firstDay = new Date(year, month, 1).getDay();
        const daysInMonth = new Date(year, month + 1, 0).getDate();
        
        // Add empty cells for days before month starts
        for (let i = 0; i < firstDay; i++) {
          const emptyCell = document.createElement('div');
          emptyCell.className = 'date';
          calendarDates.appendChild(emptyCell);
        }
        
        // Add days of the month
        for (let day = 1; day <= daysInMonth; day++) {
          const dateCell = document.createElement('div');
          dateCell.className = 'date';
          dateCell.textContent = day;
          
          // Check if this is today
          if (year === today.getFullYear() && month === today.getMonth() && day === today.getDate()) {
            dateCell.classList.add('today');
          }
          
          // Check if there's a post on this date
          const dateString = `${year}-${String(month + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
          if (postDates.includes(dateString)) {
            dateCell.classList.add('has-post');
            dateCell.title = '블로그 포스트가 있는 날';
          }
          
          calendarDates.appendChild(dateCell);
        }
      }
      
      prevBtn.addEventListener('click', function() {
        currentDate.setMonth(currentDate.getMonth() - 1);
        generateCalendar();
      });
      
      nextBtn.addEventListener('click', function() {
        currentDate.setMonth(currentDate.getMonth() + 1);
        generateCalendar();
      });
      
      // Initialize calendar
      generateCalendar();
    });
  </script>
</body>
</html>
